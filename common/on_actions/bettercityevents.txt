#CAPITAL CITIES
on_actions = {
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM.FROM = { #Add all the states concerned by events here (CAPITALS)
						OR = {
							state = 113 #Dublin
							state = 112 #Lisbon
							state = 3 #Berne
							state = 8 #Luxemburg
							state = 7 #Amsterdam
						}
					}
				}
				if = { #Dublin
					limit = {
						FROM.FROM = {
							state = 113
						}
					}
					if = { #Captured
						limit = {
							NOT = {
								any_country = {
									has_global_flag = bettercitynews_fall_of_dublin
									has_global_flag = bettercitynews_liberation_of_dublin
								}
							}
							FROM = {
								has_war_with = ROOT
								owns_state = 113
								NOT = {
									controls_state = 113
									has_capitulated = yes
								}
							}
							ROOT = {
								has_war_with = FROM
								controls_state = 113
								NOT = {
									owns_state = 113
								}
							}
						}
						FROM = {
							save_global_event_target_as = bettercitynews_fall_of_dublin_owner
							set_global_flag = bettercitynews_fall_of_dublin
						}
						ROOT = {
							save_global_event_target_as = bettercitynews_fall_of_dublin_controller
							news_event = { id = bettercitynews.1 hours = 5 }
						}
					}
					else_if = { #Liberated
						limit = {
							any_country = {
								has_global_flag = bettercitynews_fall_of_dublin
							}
							NOT = {
								any_country = {
									has_global_flag = bettercitynews_liberation_of_dublin
								}
							}
							FROM = {
								tag = event_target:bettercitynews_fall_of_dublin_controller
								NOT = {
									controls_state = 113
									owns_state = 113
									tag = event_target:bettercitynews_fall_of_dublin_owner
								}
							}
							ROOT = {
								tag = event_target:bettercitynews_fall_of_dublin_owner
								controls_state = 113
								owns_state = 113
								NOT = {
									tag = event_target:bettercitynews_fall_of_dublin_controller
								}
							}
						}
						ROOT = {
							clr_global_flag = bettercitynews_fall_of_dublin
							set_global_flag = bettercitynews_liberation_of_dublin
							news_event = { id = bettercitynews.2 hours = 5 }
						}
					}
				}

				else_if = { #Lisbon
					limit = {
						FROM.FROM = {
							state = 112
						}
					}
					if = { #Captured
						limit = {
							NOT = {
								any_country = {
									has_global_flag = bettercitynews_fall_of_lisbon
									has_global_flag = bettercitynews_liberation_of_lisbon
								}
							}
							FROM = {
								has_war_with = ROOT
								owns_state = 112
								NOT = {
									controls_state = 112
									has_capitulated = yes
								}
							}
							ROOT = {
								has_war_with = FROM
								controls_state = 112
								NOT = {
									owns_state = 112
								}
							}
						}
						FROM = {
							save_global_event_target_as = bettercitynews_fall_of_lisbon_owner
							set_global_flag = bettercitynews_fall_of_lisbon
						}
						ROOT = {
							save_global_event_target_as = bettercitynews_fall_of_lisbon_controller
							news_event = { id = bettercitynews.3 hours = 5 }
						}
					}
					else_if = { #Liberated
						limit = {
							any_country = {
								has_global_flag = bettercitynews_fall_of_lisbon
							}
							NOT = {
								any_country = {
									has_global_flag = bettercitynews_liberation_of_lisbon
								}
							}
							FROM = {
								tag = event_target:bettercitynews_fall_of_lisbon_controller
								NOT = {
									controls_state = 112
									owns_state = 112
									tag = event_target:bettercitynews_fall_of_lisbon_owner
								}
							}
							ROOT = {
								tag = event_target:bettercitynews_fall_of_lisbon_owner
								controls_state = 112
								owns_state = 112
								NOT = {
									tag = event_target:bettercitynews_fall_of_lisbon_controller
								}
							}
						}
						ROOT = {
							clr_global_flag = bettercitynews_fall_of_lisbon
							set_global_flag = bettercitynews_liberation_of_lisbon
							news_event = { id = bettercitynews.4 hours = 5 }
						}
					}
				}

				else_if = { #Berne
					limit = {
						FROM.FROM = {
							state = 3
						}
					}
					if = { #Captured
						limit = {
							NOT = {
								any_country = {
									has_global_flag = bettercitynews_fall_of_berne
									has_global_flag = bettercitynews_liberation_of_berne
								}
							}
							FROM = {
								has_war_with = ROOT
								owns_state = 3
								NOT = {
									controls_state = 3
									has_capitulated = yes
								}
							}
							ROOT = {
								has_war_with = FROM
								controls_state = 3
								NOT = {
									owns_state = 3
								}
							}
						}
						FROM = {
							save_global_event_target_as = bettercitynews_fall_of_berne_owner
							set_global_flag = bettercitynews_fall_of_berne
						}
						ROOT = {
							save_global_event_target_as = bettercitynews_fall_of_berne_controller
							news_event = { id = bettercitynews.5 hours = 5 }
						}
					}
					else_if = { #Liberated
						limit = {
							any_country = {
								has_global_flag = bettercitynews_fall_of_berne
							}
							NOT = {
								any_country = {
									has_global_flag = bettercitynews_liberation_of_berne
								}
							}
							FROM = {
								tag = event_target:bettercitynews_fall_of_berne_controller
								NOT = {
									controls_state = 3
									owns_state = 3
									tag = event_target:bettercitynews_fall_of_berne_owner
								}
							}
							ROOT = {
								tag = event_target:bettercitynews_fall_of_berne_owner
								controls_state = 3
								owns_state = 3
								NOT = {
									tag = event_target:bettercitynews_fall_of_berne_controller
								}
							}
						}
						ROOT = {
							clr_global_flag = bettercitynews_fall_of_berne
							set_global_flag = bettercitynews_liberation_of_berne
							news_event = { id = bettercitynews.6 hours = 5 }
						}
					}
				}

				else_if = { #Luxemburg
					limit = {
						FROM.FROM = {
							state = 8
						}
					}
					if = { #Captured
						limit = {
							NOT = {
								any_country = {
									has_global_flag = bettercitynews_fall_of_luxemburg
									has_global_flag = bettercitynews_liberation_of_luxemburg
								}
							}
							FROM = {
								has_war_with = ROOT
								owns_state = 8
								NOT = {
									controls_state = 8
									has_capitulated = yes
								}
							}
							ROOT = {
								has_war_with = FROM
								controls_state = 8
								NOT = {
									owns_state = 8
								}
							}
						}
						FROM = {
							save_global_event_target_as = bettercitynews_fall_of_luxemburg_owner
							set_global_flag = bettercitynews_fall_of_luxemburg
						}
						ROOT = {
							save_global_event_target_as = bettercitynews_fall_of_luxemburg_controller
							news_event = { id = bettercitynews.7 hours = 5 }
						}
					}
					else_if = { #Liberated
						limit = {
							any_country = {
								has_global_flag = bettercitynews_fall_of_luxemburg
							}
							NOT = {
								any_country = {
									has_global_flag = bettercitynews_liberation_of_luxemburg
								}
							}
							FROM = {
								tag = event_target:bettercitynews_fall_of_luxemburg_controller
								NOT = {
									controls_state = 8
									owns_state = 8
									tag = event_target:bettercitynews_fall_of_luxemburg_owner
								}
							}
							ROOT = {
								tag = event_target:bettercitynews_fall_of_luxemburg_owner
								controls_state = 8
								owns_state = 8
								NOT = {
									tag = event_target:bettercitynews_fall_of_luxemburg_controller
								}
							}
						}
						ROOT = {
							clr_global_flag = bettercitynews_fall_of_luxemburg
							set_global_flag = bettercitynews_liberation_of_luxemburg
							news_event = { id = bettercitynews.8 hours = 5 }
						}
					}
				}

				else_if = { #Amsterdam
					limit = {
						FROM.FROM = {
							state = 7
						}
					}
					if = { #Captured
						limit = {
							NOT = {
								any_country = {
									has_global_flag = bettercitynews_fall_of_amsterdam
									has_global_flag = bettercitynews_liberation_of_amsterdam
								}
							}
							FROM = {
								has_war_with = ROOT
								owns_state = 7
								NOT = {
									controls_state = 7
									has_capitulated = yes
								}
							}
							ROOT = {
								has_war_with = FROM
								controls_state = 7
								NOT = {
									owns_state = 7
								}
							}
						}
						FROM = {
							save_global_event_target_as = bettercitynews_fall_of_amsterdam_owner
							set_global_flag = bettercitynews_fall_of_amsterdam
						}
						ROOT = {
							save_global_event_target_as = bettercitynews_fall_of_amsterdam_controller
							news_event = { id = bettercitynews.11 hours = 5 }
						}
					}
					else_if = { #Liberated
						limit = {
							any_country = {
								has_global_flag = bettercitynews_fall_of_amsterdam
							}
							NOT = {
								any_country = {
									has_global_flag = bettercitynews_liberation_of_amsterdam
								}
							}
							FROM = {
								tag = event_target:bettercitynews_fall_of_lamsterdam_controller
								NOT = {
									controls_state = 7
									owns_state = 7
									tag = event_target:bettercitynews_fall_of_amsterdam_owner
								}
							}
							ROOT = {
								tag = event_target:bettercitynews_fall_of_amsterdam_owner
								controls_state = 7
								owns_state = 7
								NOT = {
									tag = event_target:bettercitynews_fall_of_amsterdam_controller
								}
							}
						}
						ROOT = {
							clr_global_flag = bettercitynews_fall_of_lamsterdam
							set_global_flag = bettercitynews_liberation_of_amsterdam
							news_event = { id = bettercitynews.12 hours = 5 }
						}
					}
				}

			}
		}
	}
}

#NON-CAPITAL CITIES
on_actions = {
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM.FROM = { #Add all the states concerned by events here (NON-CAPITALS)
						OR = {
							state = 151 #Zürich
							state = 6 #Flanders
						}
					}
				}
				if = { #Zürich
					limit = {
						FROM.FROM = {
							state = 151
						}
						NOT = {
							any_country = {
								has_global_flag = bettercitynews_fall_of_zurich
							}
						}
						FROM = {
							has_war_with = ROOT
							owns_state = 151
							NOT = {
								controls_state = 151
								has_capitulated = yes
							}
						}
						ROOT = {
							has_war_with = FROM
							controls_state = 151
							NOT = {
								owns_state = 151
							}
						}
					}
					FROM = {
						save_global_event_target_as = bettercitynews_fall_of_zurich_owner
						set_global_flag = bettercitynews_fall_of_zurich
					}
					ROOT = {
						save_global_event_target_as = bettercitynews_fall_of_zurich_controller
						news_event = { id = bettercitynews.7 hours = 5 }
					}
				}

				if = { #Flanders
					limit = {
						FROM.FROM = {
							state = 6
						}
						NOT = {
							any_country = {
								has_global_flag = bettercitynews_fall_of_flanders
							}
						}
						FROM = {
							has_war_with = ROOT
							owns_state = 6
							NOT = {
								controls_state = 6
								has_capitulated = yes
							}
						}
						ROOT = {
							has_war_with = FROM
							controls_state = 6
							NOT = {
								owns_state = 6
							}
						}
					}
					FROM = {
						save_global_event_target_as = bettercitynews_fall_of_flanders_owner
						set_global_flag = bettercitynews_fall_of_flanders
					}
					ROOT = {
						save_global_event_target_as = bettercitynews_fall_of_flanders_controller
						news_event = { id = bettercitynews.10 hours = 5 }
					}
				}
			}
		}
	}
}